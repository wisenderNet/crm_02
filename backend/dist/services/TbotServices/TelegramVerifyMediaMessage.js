'use strict';
function a() {
    const V = [
        'getFileLin',
        'AD_MEDIA::',
        'igwmI',
        'defineProp',
        'EudjG',
        'PpNZm',
        'YAWnB',
        'toString',
        'REgIh',
        'finish',
        'nJLxF',
        'DltCt',
        '1815810aYseSb',
        'axios',
        '\x20ID:\x20',
        'tyILF',
        'getTime',
        'XplUH',
        'SAD',
        'fdEPy',
        'SAV',
        'photo',
        '10ONPMGc',
        'file_id',
        'public',
        'util',
        'yHlmH',
        'opWla',
        'logger',
        'haVAt',
        'tenantId',
        '293013hjiZcR',
        'gjlBN',
        'received',
        'getFile',
        's/logger',
        'NrKKV',
        'LOAD',
        'Services/C',
        'reply_to_m',
        'nqVhN',
        '3902108JqkRtO',
        'reateMessa',
        'telegram',
        '24CEkUCh',
        'image/webp',
        'jAuQO',
        'PEqgq',
        'error',
        'MoEPA',
        'fileName',
        'sage',
        'VEDWV',
        'update',
        'join',
        'KgdHN',
        '../Message',
        'document',
        'ageId',
        'oVljH',
        'SAS',
        '16470212HZwFDs',
        'lLwTP',
        'woEtm',
        'geService',
        'hKogq',
        'TqMko',
        'pipe',
        'JCBob',
        'date',
        'NMYIM',
        'split',
        'ERROR\x20DONW',
        'BqoCq',
        'default',
        'edited_mes',
        'knLAh',
        'path',
        'stream',
        '2230317nIZXKb',
        '../../help',
        '21BKJmDm',
        '1456189tYtBkO',
        'image/png',
        'fileId',
        '2JfOjmq',
        'video',
        'length',
        'MOiMO',
        'erty',
        'JrGlD',
        'pgKGT',
        'value',
        'VacHr',
        'wYPEO',
        'data',
        'createWrit',
        'VMCVb',
        'caption',
        'zbbnN',
        'sended',
        'wfnJl',
        'mime_type',
        'pMQgN',
        'GET',
        '3132848iHGsqZ',
        '__importDe',
        'eStream',
        'sticker',
        'eaOwg',
        'ERR_DOWNLO',
        'PPZZN',
        'text',
        'ZkBLg',
        'messageDat',
        'is_animate',
        'AuUlF',
        'lmRSw',
        'promisify',
        'writeFile',
        'ers/getQuo',
        'essage',
        'MvIlM',
        '__esModule',
        '../../util',
        'type',
        'audio',
        'tedForMess',
        'mimeType',
        'jSyak',
        'fault',
        'OBGVY',
        'tQPOF',
        'file_name',
        'message_id',
        'message',
        'jsHWd',
        'jEkaH',
        'voice'
    ];
    a = function () {
        return V;
    };
    return a();
}
const E = b, F = b;
(function (c, d) {
    const C = b, D = b, e = c();
    while (!![]) {
        try {
            const f = -parseInt(C(0xf6)) / (0x3b * 0x2e + 0x2295 + -0x2d2e) + -parseInt(C(0xf9)) / (-0xed9 + -0x4f * 0x71 + 0x31ba) * (parseInt(D(0xf3)) / (0x21ae + -0x2fb * 0xc + 0x219)) + -parseInt(C(0xcd)) / (0x3 * -0xad9 + -0x2605 * 0x1 + -0x4694 * -0x1) + parseInt(C(0xb0)) / (0xbc * -0x21 + 0xeda + 0x53 * 0x1d) * (parseInt(D(0xd0)) / (-0x2 * -0x6e2 + -0x1025 * -0x1 + -0x1de3)) + -parseInt(C(0xf5)) / (-0x3e * 0x6c + -0x24ae + 0x3edd) * (-parseInt(D(0x82)) / (0x2d7 + -0x17a8 + 0x14d9)) + parseInt(C(0xc3)) / (0x1f77 + -0x29 * 0xf + 0x1 * -0x1d07) * (parseInt(D(0xba)) / (-0xe44 + 0x24a + -0x1 * -0xc04)) + parseInt(C(0xe1)) / (0x2151 + 0x1236 + 0xcdf * -0x4);
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, -0x123b00 + -0x1c9a11 * 0x1 + -0x1 * -0x3dd1a1));
var __importDefault = this && this[E(0x83) + F(0x9b)] || function (c) {
    const G = F;
    return c && c[G(0x94)] ? c : { 'default': c };
};
const u = {};
u[F(0x75)] = !![], Object[F(0xa7) + E(0xfd)](exports, F(0x94), u);
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0x1 * -0x1dad + 0xd4 * 0x13 + -0x3 * -0x4cc);
        let h = e[f];
        return h;
    }, b(c, d);
}
const path_1 = require(E(0xf1)), util_1 = require(F(0xbd)), fs_1 = require('fs'), axios_1 = __importDefault(require(E(0xb1))), CreateMessageService_1 = __importDefault(require(F(0xdc) + F(0xca) + F(0xce) + E(0xe4))), logger_1 = require(F(0x95) + F(0xc7)), getQuotedForMessageId_1 = __importDefault(require(E(0xf4) + F(0x91) + F(0x98) + E(0xde))), writeFileAsync = (-0x2402 + -0x1ea6 + 0x42a8, util_1[E(0x8f)])(fs_1[F(0x90)]), getMediaInfo = j => {
        const H = F, I = F, k = {};
        k[H(0xfc)] = H(0xb9), k[H(0xed)] = I(0xfa), k[I(0xe2)] = I(0x97), k[I(0x77)] = H(0xa3), k[H(0xe8)] = I(0x85), k[H(0x73)] = I(0xdd), k[I(0x8a)] = function (w, z) {
            return w - z;
        }, k[I(0xe3)] = function (w, z) {
            return w == z;
        }, k[H(0x8d)] = I(0xf7), k[H(0x74)] = I(0xd1);
        const l = k, m = j[I(0xb9)] ? l[I(0xfc)] : j[H(0xfa)] ? l[H(0xed)] : j[I(0x97)] ? l[H(0xe2)] : j[I(0xa3)] ? l[H(0x77)] : j[H(0x85)] && !j[H(0x85)][H(0x8c) + 'd'] ? l[I(0xe8)] : l[I(0x73)], n = j[m], [o, p, q, r, s, t, v] = [
                m,
                n[I(0x7f)] ? n[I(0x7f)] : '',
                ![],
                null,
                n[H(0xbb)] ? n[H(0xbb)] : n[l[H(0x8a)](n[H(0xfb)], -0x2c * -0x76 + 0x18e2 + -0x2d29 * 0x1)][I(0xbb)],
                j[H(0x7b)] ? j[I(0x7b)] : '',
                l[H(0xe3)](m, l[I(0x77)])
            ];
        switch (m) {
        case l[I(0xfc)]:
            const w = {};
            w[H(0x96)] = o, w[I(0x99)] = l[I(0x8d)], w[H(0xb6)] = q, w[I(0xd6)] = r, w[I(0xf8)] = s, w[I(0x7b)] = t, w[I(0xb8)] = v;
            return w;
            break;
        case l[H(0xed)]:
            const x = {};
            x[I(0x96)] = o, x[H(0x99)] = p, x[H(0xb6)] = q, x[I(0xd6)] = r, x[H(0xf8)] = s, x[I(0x7b)] = t, x[H(0xb8)] = v;
            return x;
            break;
        case l[H(0xe2)]:
            const y = {};
            y[I(0x96)] = o, y[I(0x99)] = p, y[H(0xb6)] = q, y[H(0xd6)] = r, y[I(0xf8)] = s, y[H(0x7b)] = t, y[I(0xb8)] = v;
            return y;
            break;
        case l[H(0x77)]:
            const z = {};
            z[H(0x96)] = o, z[I(0x99)] = p, z[I(0xb6)] = q, z[I(0xd6)] = r, z[I(0xf8)] = s, z[H(0x7b)] = t, z[H(0xb8)] = v;
            return z;
            break;
        case l[H(0xe8)]:
            const A = {};
            A[I(0x96)] = o, A[I(0x99)] = l[I(0x74)], A[I(0xb6)] = q, A[H(0xd6)] = r, A[H(0xf8)] = s, A[I(0x7b)] = t, A[H(0xb8)] = v, A[H(0xe0)] = !![];
            return A;
            break;
        default:
            const B = {};
            B[I(0x96)] = o, B[I(0x99)] = p, B[I(0xb6)] = !![], B[I(0xd6)] = n[I(0x9e)] ? n[I(0x9e)] : null, B[H(0xf8)] = s, B[H(0x7b)] = t, B[I(0xb8)] = v;
            return B;
            break;
        }
    }, downloadFile = async (c, d) => {
        const J = E, K = F, e = {
                'PPZZN': function (g, h) {
                    return g === h;
                },
                'MvIlM': J(0x7a),
                'gjlBN': J(0xec) + K(0xc9),
                'REgIh': function (g, h) {
                    return g(h);
                },
                'yHlmH': function (g, h) {
                    return g(h);
                },
                'PpNZm': J(0xad),
                'VEDWV': K(0xd4),
                'hKogq': function (g, h) {
                    return g === h;
                },
                'jAuQO': K(0x76),
                'nqVhN': K(0x81),
                'PEqgq': K(0xf2)
            }, f = await (-0xdb0 + -0x17bf + 0x256f * 0x1, axios_1[K(0xee)])({
                'url': c[J(0xab)](),
                'method': e[K(0xcc)],
                'responseType': e[J(0xd3)]
            });
        await new Promise((g, h) => {
            const L = K, N = J, i = {
                    'haVAt': e[L(0xc4)],
                    'opWla': function (j, k) {
                        const M = L;
                        return e[M(0xbe)](j, k);
                    },
                    'lmRSw': e[L(0xa9)],
                    'YAWnB': e[N(0xd8)]
                };
            if (e[L(0xe5)](e[N(0xd2)], e[L(0xd2)]))
                f[L(0x78)][L(0xe7)]((0x450 + 0x6e + -0x4be, fs_1[N(0x79) + L(0x84)])(d))['on'](e[N(0xa9)], async () => g(!![]))['on'](e[L(0xd8)], j => {
                    const O = L, P = N;
                    if (e[O(0x88)](e[O(0x93)], e[O(0x93)]))
                        console[O(0xd4)](e[P(0xc4)], j), e[P(0xac)](h, new Error(j));
                    else {
                        e[P(0xc0)][O(0xd4)](O(0x87) + P(0xa5) + P(0xb2) + f[O(0x9f)]);
                        return;
                    }
                });
            else {
                const k = {
                    'knLAh': i[N(0xc1)],
                    'igwmI': function (l, m) {
                        const Q = L;
                        return i[Q(0xbf)](l, m);
                    }
                };
                j[L(0x78)][N(0xe7)]((0xd5 * -0x21 + -0x6 * -0x108 + -0xa5 * -0x21, k[N(0x79) + N(0x84)])(l))['on'](i[N(0x8e)], async () => q(!![]))['on'](i[L(0xaa)], v => {
                    const R = N, S = N;
                    q[R(0xd4)](k[R(0xf0)], v), k[S(0xa6)](r, new s(v));
                });
            }
        });
    }, VerifyMediaMessage = async (d, e, f, g) => {
        const T = E, U = E, h = {
                'TqMko': T(0xec) + T(0xc9),
                'jEkaH': function (v, w) {
                    return v(w);
                },
                'zbbnN': function (v, w) {
                    return v && w;
                },
                'pMQgN': function (v, w) {
                    return v !== w;
                },
                'nJLxF': U(0xdb),
                'jSyak': function (v, w) {
                    return v !== w;
                },
                'wfnJl': U(0xb5),
                'NMYIM': T(0xbc),
                'fdEPy': function (v, w, x) {
                    return v(w, x);
                },
                'oVljH': function (v, w) {
                    return v !== w;
                },
                'MoEPA': T(0xa1),
                'eaOwg': U(0xc8),
                'tyILF': function (v, w) {
                    return v(w);
                },
                'EudjG': function (v, w) {
                    return v * w;
                },
                'OBGVY': U(0x7d),
                'DltCt': T(0xc5),
                'tQPOF': function (v, w) {
                    return v || w;
                }
            };
        let i, j = {};
        i = d?.[U(0xa0)], j = d?.[U(0xd9)];
        h[U(0x7c)](!i, j) && (h[T(0x80)](h[U(0xae)], h[U(0xae)]) ? (h[U(0xd4)](h[U(0xe6)], i), h[T(0xa2)](j, new k(l))) : i = j?.[T(0xef) + U(0xd7)]);
        const k = await h[T(0xa2)](getMediaInfo, i), l = await d[T(0xcf)][U(0xc6)](k[U(0xf8)]);
        if (!l) {
            if (h[T(0x9a)](h[U(0x7e)], h[U(0x7e)])) {
                const x = {};
                return x[U(0xee)] = j, g && h[U(0x94)] ? i : x;
            } else {
                logger_1[T(0xc0)][T(0xd4)](T(0x87) + T(0xa5) + U(0xb2) + i[U(0x9f)]);
                return;
            }
        }
        const m = k[U(0x99)][T(0xeb)]('/')[-0x58f * -0x5 + 0x25b * 0x8 + -0x2ea2][U(0xeb)](';')[-0x8c8 + -0x1280 + 0x1b48], n = l[T(0xbb)] + '_' + new Date()[T(0xb4)]() + '.' + m, o = (-0x18d1 + -0x3 * 0xf3 + -0xdd5 * -0x2, path_1[T(0xda)])(__dirname, '..', '..', '..', h[U(0xea)], n), p = await d[T(0xcf)][U(0xa4) + 'k'](k[U(0xf8)]);
        await h[U(0xb7)](downloadFile, p, o);
        let q;
        if (i?.[U(0xcb) + T(0x92)]?.[U(0x9f)]) {
            if (h[U(0xdf)](h[U(0xd5)], h[T(0x86)])) {
                const x = await (-0x6 * 0x656 + -0x22f3 + -0x1 * -0x48f7, getQuotedForMessageId_1[U(0xee)])(i[T(0xcb) + U(0x92)][T(0x9f)], f[U(0xc2)]);
                q = x?.['id'] || undefined;
            } else
                e = f?.[U(0xef) + T(0xd7)];
        }
        const r = {
            'messageId': h[T(0xb3)](String, i?.[U(0x9f)]),
            'ticketId': f['id'],
            'contactId': e ? undefined : g['id'],
            'body': i[U(0x89)] || i[U(0x7b)] || n,
            'fromMe': e,
            'read': e,
            'mediaUrl': n,
            'mediaType': k[U(0x99)][U(0xeb)]('/')[0x5d * -0x17 + 0x1e15 * -0x1 + 0x2670],
            'quotedMsgId': q,
            'timestamp': h[U(0xa8)](+i[T(0xe9)], -0x20c9 + -0x228c + 0x473d),
            'status': e ? h[U(0x9c)] : h[U(0xaf)]
        };
        await f[U(0xd9)]({
            'lastMessage': i[T(0x89)] || i[U(0x7b)] || n,
            'lastMessageAt': new Date()[U(0xb4)](),
            'answered': h[T(0x9d)](e, ![])
        });
        const s = {};
        s[T(0x8b) + 'a'] = r, s[T(0xc2)] = f[U(0xc2)];
        const t = await (0x12a7 + -0x2 * 0x467 + -0x1 * 0x9d9, CreateMessageService_1[T(0xee)])(s);
        return t;
    };
exports[F(0xee)] = VerifyMediaMessage;