'use strict';
const T = b, U = b;
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (-0xa9e * -0x1 + 0x1c * 0xae + -0x65 * 0x4a);
        let h = e[f];
        return h;
    }, b(c, d);
}
(function (c, d) {
    const R = b, S = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(R(0xee)) / (-0x1 * 0x19b5 + -0x1 * 0x128f + 0x2c45) + -parseInt(S(0xd7)) / (0x1 * -0x1e95 + -0x74c + -0x3d * -0x9f) + -parseInt(R(0x96)) / (-0x25f4 + 0x39c + 0x225b) * (-parseInt(S(0xec)) / (0x2 * -0xe6f + -0x1a * -0xfc + -0x1 * -0x34a)) + -parseInt(R(0xcc)) / (-0x56 * -0x65 + 0x2 * 0x588 + -0x2cf9) + -parseInt(S(0xb4)) / (-0x239b * -0x1 + -0x3ef * 0x7 + 0x406 * -0x2) * (-parseInt(R(0xe7)) / (0xf * 0xe0 + -0x2 * -0x909 + 0x1f2b * -0x1)) + -parseInt(R(0xc6)) / (0x1f * -0x97 + 0x66e + 0xbe3) * (parseInt(S(0xf1)) / (-0xc0a + -0x9b * 0x16 + -0x3 * -0x877)) + parseInt(R(0x8a)) / (-0x26 * -0x101 + 0x1292 + -0x38ae) * (parseInt(R(0xb7)) / (-0x35 * -0x8 + 0x11e3 * -0x1 + 0x1046));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x3 * 0x5197f + 0xcd652 + -0x118b06));
var __importDefault = this && this[T(0x74) + U(0xcb)] || function (c) {
    const V = U;
    return c && c[V(0xf7)] ? c : { 'default': c };
};
function a() {
    const a0 = [
        'CWfUe',
        'ack',
        'where',
        'fs/promise',
        'SEFCJ',
        'JGSZC',
        'broadcastT',
        '../../util',
        ')::\x20',
        'jPIQF',
        'NXBxl',
        '177iFPjcr',
        'gDGjy',
        'path',
        'image',
        'ext',
        'ticket',
        'eiKMI',
        'broadcastP',
        'iQJVN',
        'hoto',
        'domTime',
        'status',
        'Cwkps',
        'Error\x20send',
        'id:\x20',
        'toFormat',
        'instagram',
        'Emit',
        'mp4',
        'closed',
        'aUNUI',
        'ptt',
        'saveToFile',
        'broadcastV',
        'body',
        'item_id',
        'toBuffer',
        'Message\x20Up',
        '../../mode',
        'entity',
        '6qKWNtb',
        'value',
        'contact',
        '742621tdVwhp',
        'AHsYF',
        'default',
        'directThre',
        'fluent-ffm',
        'jkvPq',
        'e\x20text',
        'ls/Ticket',
        '\x20message\x20(',
        'sleepRando',
        'YMTdu',
        'sharp',
        '../../help',
        's/logger',
        'axvoG',
        '16GeDCye',
        'amssy',
        'file',
        'ByqSm',
        'tenantId',
        'fault',
        '2443855QBcrNn',
        'NrkpR',
        'ers/socket',
        'mediaType',
        'ls/Message',
        'lte',
        'lGEbp',
        'nant:\x20',
        'WSkBj',
        'humGq',
        'timestamp',
        '1883732SAIXIy',
        'includes',
        '\x20|\x20Ticket:',
        'xJYLB',
        'readFile',
        'text',
        'logger',
        'rVPoR',
        'findAll',
        'CGXTR',
        'sendMessag',
        'split',
        'erty',
        'public',
        '.mp4',
        'defineProp',
        '6945001Fkyvme',
        'ideo',
        'quotedMsg',
        'join',
        'createdAt',
        '91256PoAFKp',
        'peg',
        '254589gBZNmf',
        'e\x20media',
        'date\x20ok',
        '3320766GHtWcD',
        'info',
        'type',
        'pending',
        'sequelize',
        'mediaUrl',
        '__esModule',
        'fkSyP',
        'WXncK',
        'oice',
        'XezuC',
        'end',
        '__importDe',
        'update',
        'dataValues',
        'error',
        'audio',
        'messageId',
        'Error\x20mess',
        'ASC',
        'EPQgR',
        'jpeg',
        'payload',
        'mediaName',
        'instagramP',
        'mTime',
        's/sleepRan',
        'bsjDe',
        'chat',
        'chat:ack',
        'video',
        'age\x20is\x20(te',
        'log',
        'sended',
        '40yxCltp'
    ];
    a = function () {
        return a0;
    };
    return a();
}
const q = {};
q[T(0xb5)] = !![], Object[T(0xe6) + T(0xe3)](exports, U(0xf7), q);
const promises_1 = require(T(0x8e) + 's'), fluent_ffmpeg_1 = __importDefault(require(T(0xbb) + U(0xed))), path_1 = require(U(0x98)), sequelize_1 = require(U(0xf5)), sharp_1 = __importDefault(require(U(0xc2))), socketEmit_1 = __importDefault(require(T(0xc3) + T(0xce) + T(0xa7))), Message_1 = __importDefault(require(U(0xb2) + U(0xd0))), Ticket_1 = __importDefault(require(T(0xb2) + T(0xbe))), logger_1 = require(T(0x92) + U(0xc4)), sleepRandomTime_1 = require(U(0x92) + U(0x82) + U(0xa0)), SendMessagesSystemWbot = async (l, m) => {
        const W = T, X = U, n = {
                'xJYLB': W(0xa8),
                'NXBxl': X(0x77),
                'fkSyP': X(0xfc),
                'WXncK': X(0xf4),
                'humGq': W(0xb6),
                'axvoG': X(0x9b),
                'CGXTR': W(0xa9),
                'aUNUI': W(0xa6),
                'gDGjy': X(0xe9),
                'NrkpR': W(0xeb),
                'JGSZC': X(0x7b),
                'jkvPq': X(0x84),
                'SEFCJ': X(0xdc),
                'rVPoR': W(0xe4),
                'jPIQF': function (t, u) {
                    return t === u;
                },
                'iQJVN': W(0x78),
                'Cwkps': function (t, u) {
                    return t === u;
                },
                'EPQgR': X(0xab),
                'YMTdu': W(0x99),
                'AHsYF': function (t, u) {
                    return t === u;
                },
                'amssy': X(0x86),
                'WSkBj': W(0xe1) + W(0xef),
                'lGEbp': W(0xe1) + W(0xbd),
                'XezuC': W(0x89),
                'eiKMI': W(0x85),
                'bsjDe': X(0xb1) + W(0xf0),
                'ByqSm': function (t, u) {
                    return t(u);
                },
                'CWfUe': function (t, u) {
                    return t(u);
                }
            }, o = { [sequelize_1['Op']['is']]: null }, p = {
                'fromMe': !![],
                'messageId': o,
                'status': n[X(0xf9)],
                [sequelize_1['Op']['or']]: [
                    { 'scheduleDate': { [sequelize_1['Op'][X(0xd1)]]: new Date() } },
                    { 'scheduleDate': { [sequelize_1['Op']['is']]: null } }
                ]
            }, r = await Message_1[W(0xb9)][X(0xdf)]({
                'where': p,
                'include': [
                    n[X(0xd5)],
                    {
                        'model': Ticket_1[W(0xb9)],
                        'as': n[X(0xc5)],
                        'where': {
                            'tenantId': m,
                            [sequelize_1['Op']['or']]: {
                                'status': { [sequelize_1['Op']['ne']]: n[X(0xe0)] },
                                'isFarewellMessage': !![]
                            },
                            'channel': n[X(0xaa)],
                            'whatsappId': l['id']
                        },
                        'include': [n[X(0xd5)]]
                    },
                    {
                        'model': Message_1[W(0xb9)],
                        'as': n[X(0x97)],
                        'include': [n[X(0xd5)]]
                    }
                ],
                'order': [[
                        n[X(0xcd)],
                        n[X(0x90)]
                    ]]
            });
        let s;
        for (const t of r) {
            const u = t, {ticket: v} = u, w = v[W(0xb6)][W(0x80) + 'K'], x = await l[W(0xb3)][X(0xba) + 'ad']([w]);
            try {
                if (![
                        n[W(0xbc)],
                        n[W(0x8f)]
                    ][W(0xd8)](u[X(0xcf)]) && u[W(0x7f)]) {
                    const E = (0x7 * 0x49a + 0xf75 + -0x2fab * 0x1, path_1[X(0xea)])(__dirname, '..', '..', '..', n[X(0xde)]), F = (-0xb9 * 0x12 + -0x4 * 0x33b + 0x19ee, path_1[X(0xea)])(E, u[W(0x7f)]), G = await (0xb3 * -0xb + -0x86 * -0x2c + -0xf57, promises_1[W(0xdb)])(F);
                    console[X(0x88)](F);
                    if (n[X(0x94)](u[W(0xcf)], n[X(0x9e)]) || n[W(0xa2)](u[X(0xcf)], n[X(0x7c)])) {
                        const H = u[W(0x7f)][W(0xe2)]('.'), I = (0x2 * -0xe41 + -0x243a + -0xaca * -0x6, path_1[X(0xea)])(E, H[-0x2428 + 0x1696 + 0xd92] + X(0xe5));
                        await new Promise((L, M) => {
                            const Y = X, Z = X;
                            (-0x3 * 0xbb6 + 0x4bf + 0x1e63, fluent_ffmpeg_1[Y(0xb9)])(F)[Z(0xa5)](n[Y(0xda)])['on'](n[Y(0x95)], N => M(N))['on'](n[Y(0xf8)], () => L(!![]))[Z(0xac)](I);
                        });
                        const J = await (0x1 * 0x938 + -0x188f + 0xf57, promises_1[W(0xdb)])(I), K = {};
                        K[X(0xc8)] = J, s = await x[X(0xad) + W(0xfa)](K);
                    }
                    if (n[X(0x94)](u[X(0xcf)], n[W(0xc1)])) {
                        const L = await (-0x59f * 0x1 + -0x696 * -0x1 + -0xf7, sharp_1[W(0xb9)])(G)[X(0x7d)]()[X(0xb0)](), M = {};
                        M[W(0xc8)] = L, s = await x[X(0x9d) + W(0x9f)](M);
                    }
                    if (n[W(0xb8)](u[W(0xcf)], n[W(0xc7)])) {
                        const N = {};
                        N[W(0x86)] = G, s = await x[W(0xad) + W(0xe8)](N);
                    }
                    logger_1[W(0xdd)][W(0xf2)](n[W(0xd4)]);
                }
                [
                    n[X(0xbc)],
                    n[W(0x8f)]
                ][X(0xd8)](u[W(0xcf)]) && !u[X(0x7f)] && (s = await x[W(0x91) + X(0x9a)](u[W(0xae)]), logger_1[W(0xdd)][W(0xf2)](n[X(0xd2)]));
                const y = {
                    ...u,
                    ...s
                };
                y['id'] = u['id'], y[W(0xd6)] = u[W(0xd6)], y[W(0x79)] = s[X(0xaf)], y[W(0xa1)] = n[X(0xfb)], y[X(0x8c)] = 0x2;
                const z = y, A = { ...z }, B = {};
                B['id'] = u['id'];
                const C = {};
                C[X(0x8d)] = B, await Message_1[X(0xb9)][W(0x75)](A, C);
                const D = {};
                D[X(0xca)] = v[W(0xca)], D[X(0xf3)] = n[W(0x9c)], D[X(0x7e)] = { ...u[X(0x76)] }, D[X(0x7e)][W(0xf6)] = u[X(0xf6)], D[X(0x7e)]['id'] = u['id'], D[X(0x7e)][W(0xd6)] = u[X(0xd6)], D[X(0x7e)][X(0x79)] = s[X(0xaf)], D[X(0x7e)][W(0xa1)] = n[X(0xfb)], D[X(0x7e)][X(0x8c)] = 0x2, (0xc58 * -0x3 + 0x1eff + 0x609, socketEmit_1[W(0xb9)])(D), logger_1[X(0xdd)][W(0xf2)](n[X(0x83)]), await (-0x14d5 + 0x6da + -0x3 * -0x4a9, sleepRandomTime_1[X(0xc0) + W(0x81)])({
                    'minMilliseconds': n[X(0xc9)](Number, -0xa97 * 0x1 + 0x7 * 0xf3 + -0x56 * -0x23),
                    'maxMilliseconds': n[W(0x8b)](Number, 0x1984 + -0x1 * -0x59f + -0x3 * 0x679)
                });
            } catch (O) {
                const P = u['id'], Q = u[X(0x9b)]['id'];
                logger_1[X(0xdd)][W(0x77)](X(0x7a) + W(0x87) + X(0xd3) + m + (W(0xd9) + '\x20') + Q + ')'), logger_1[X(0xdd)][X(0x77)](X(0xa3) + W(0xbf) + X(0xa4) + P + X(0x93) + O);
            }
        }
    };
exports[U(0xb9)] = SendMessagesSystemWbot;