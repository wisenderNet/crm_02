'use strict';
function b(c, d) {
    const e = a();
    return b = function (f, g) {
        f = f - (0xc05 + -0x1733 * 0x1 + 0x650 * 0x2);
        let h = e[f];
        return h;
    }, b(c, d);
}
const aF = b, aG = b;
(function (c, d) {
    const aD = b, aE = b, e = c();
    while (!![]) {
        try {
            const f = parseInt(aD(0x1da)) / (0x1de8 + -0x7 * 0x7e + -0x1a75) + parseInt(aD(0x19e)) / (0x90 + -0x13a + -0x56 * -0x2) + -parseInt(aE(0x1a3)) / (-0x13 * -0xa4 + -0xd99 + 0x2e * 0x8) * (-parseInt(aD(0x17e)) / (0xb3b + -0x24a0 + 0x1969)) + parseInt(aD(0x219)) / (-0x22af + 0x7d8 * -0x1 + 0x2a8c * 0x1) + parseInt(aE(0x175)) / (-0x1 * -0x84f + -0x1 * 0x1292 + 0xa49) * (-parseInt(aD(0x1d1)) / (0x1351 * -0x2 + -0x7 * -0x131 + 0x1e52)) + -parseInt(aE(0x209)) / (0x2038 + -0x1 * 0xc03 + -0x1 * 0x142d) + -parseInt(aE(0x1a4)) / (-0x4fc * -0x5 + -0x913 * -0x1 + 0x1e3 * -0x12) * (parseInt(aE(0x201)) / (0x1fd4 + -0x13e3 + 0xbe7 * -0x1));
            if (f === d)
                break;
            else
                e['push'](e['shift']());
        } catch (g) {
            e['push'](e['shift']());
        }
    }
}(a, 0x7b1d9 + 0x6d59d + 0xae6d * -0xd));
var __importDefault = this && this[aF(0x1f6) + aF(0x207)] || function (c) {
    const aH = aF;
    return c && c[aH(0x194)] ? c : { 'default': c };
};
const q = {};
function a() {
    const aK = [
        'integratio',
        'fnxan',
        'isCampaign',
        'cnZMq',
        'bGvYx',
        'type',
        'whatsappId',
        'ZuByn',
        'queueId',
        './ShowTick',
        'includes',
        '../../help',
        'vices/help',
        'CVoeo',
        'DESC',
        'EAaff',
        'messenger',
        'etService',
        'itdtc',
        'vice',
        'IFkHo',
        'sequelize',
        'body',
        'order',
        'ate',
        'name',
        '../Setting',
        'UWCpZ',
        'JnJLm',
        'tion',
        'contact',
        '35gQkWpD',
        'MMFUh',
        'mSqKo',
        'mZRnk',
        'ls/Message',
        'Wcfbz',
        'getWallets',
        'ticket:upd',
        'fwDJs',
        '692598OUjDbE',
        'csqaI',
        'getBodyMes',
        'xfMIQ',
        'NXfbB',
        'isFarewell',
        'user',
        'ls/Ticket',
        'setDataVal',
        'kJBWR',
        'gsEdV',
        'Services/L',
        'Message',
        'rEulY',
        'MtVPv',
        'find',
        'qrUTG',
        'QBdYB',
        'startedAtt',
        'sService',
        'nId',
        'kDSjh',
        'INPFR',
        'yTZWD',
        'telegram',
        'findOne',
        'enabled',
        'create',
        '__importDe',
        'instagram',
        'open',
        'ZKbnP',
        'sage',
        'payload',
        'urUHS',
        'associatio',
        'amUHg',
        'ers/Verify',
        'LgseG',
        '204290zUGDUI',
        'pending',
        'key',
        'JENLg',
        'useIntegra',
        'ages',
        'fault',
        'wallets',
        '3434424RqTEcp',
        'ls/Campaig',
        'faKDe',
        'tJdkF',
        'number',
        'ticket',
        'defineProp',
        'getTime',
        'fromMe',
        'waba',
        '../WbotSer',
        'REDGV',
        'default',
        'unreadMess',
        'isDeleted',
        'SUoiA',
        '2152845aNuheQ',
        'zEjFg',
        'ContactBai',
        'EagwS',
        'ls/Contact',
        'contactId',
        'yAijR',
        'PDuTv',
        'attributes',
        'Emit',
        '../../mode',
        'YwkQW',
        '473466TsyUvK',
        'ers/socket',
        'bxHGz',
        'lastMessag',
        'etsToWalle',
        'qcekD',
        'include',
        'Jzfmo',
        'endanceAt',
        '4zfXupv',
        'istSetting',
        'messageId',
        'ers/CheckC',
        'extraInfo',
        'YCYzz',
        'where',
        'ers/GetInt',
        'leys',
        'mhVxG',
        'OBfEh',
        'Welcome',
        'DirectTick',
        'status',
        'fYwHD',
        'ticketId',
        'VuiSa',
        'DTXYn',
        'UBAHr',
        'FSbBn',
        'nContacts',
        'hatBotFlow',
        '__esModule',
        'erty',
        'mcgfW',
        'model',
        'userId',
        'Mvmxc',
        'ls/User',
        'lrkGx',
        'egrationsI',
        'ls/Whatsap',
        '245716MPoNLU',
        'tenantId',
        'updatedAt',
        'HLQkE',
        'LgxtJ',
        '155013wZesWy',
        '45HEKQCS',
        'value',
        'tags',
        'CfJRm',
        'PgIXA',
        'YlaJN',
        'update',
        'gTicketSer',
        'HtudD',
        'isCreated',
        'whatsapp',
        'closed',
        'OtzNl',
        './CreateLo'
    ];
    a = function () {
        return aK;
    };
    return a();
}
q[aF(0x1a5)] = !![], Object[aF(0x20f) + aG(0x195)](exports, aF(0x194), q);
const sequelize_1 = require(aF(0x1c7)), Contact_1 = __importDefault(require(aG(0x173) + aG(0x21d))), Ticket_1 = __importDefault(require(aF(0x173) + aF(0x1e1))), User_1 = __importDefault(require(aG(0x173) + aG(0x19a))), ShowTicketService_1 = __importDefault(require(aF(0x1bb) + aF(0x1c3))), CampaignContacts_1 = __importDefault(require(aF(0x173) + aF(0x20a) + aG(0x192))), socketEmit_1 = __importDefault(require(aG(0x1bd) + aF(0x176) + aG(0x172))), CheckChatBotFlowWelcome_1 = __importDefault(require(aF(0x1bd) + aF(0x181) + aF(0x193) + aG(0x189))), CreateLogTicketService_1 = __importDefault(require(aG(0x1b1) + aG(0x1ab) + aG(0x1c5))), Message_1 = __importDefault(require(aG(0x173) + aG(0x1d5))), ListSettingsService_1 = __importDefault(require(aG(0x1cc) + aF(0x1e5) + aF(0x17f) + aG(0x1ed))), Whatsapp_1 = __importDefault(require(aF(0x173) + aF(0x19d) + 'p')), VerifyContactBaileys_1 = require(aG(0x213) + aF(0x1be) + aG(0x1ff) + aG(0x21b) + aF(0x186)), GetIntegrationsID_1 = __importDefault(require(aG(0x1bd) + aF(0x185) + aF(0x19c) + 'D')), FindOrCreateTicketService = async ({
        contact: F,
        whatsappId: G,
        unreadMessages: H,
        tenantId: I,
        groupContact: J,
        msg: K,
        isSync: L,
        channel: M,
        isImported: N
    }) => {
        const aI = aF, aJ = aG, O = {};
        O[aI(0x1b3)] = aJ(0x1f8), O[aI(0x177)] = function (a7, a8) {
            return a7 === a8;
        }, O[aI(0x18c)] = aJ(0x1f7), O[aJ(0x1c4)] = function (a7, a8) {
            return a7 === a8;
        }, O[aI(0x204)] = aI(0x1eb), O[aJ(0x1fc)] = aJ(0x1db), O[aJ(0x1fe)] = function (a7, a8) {
            return a7 === a8;
        }, O[aJ(0x20c)] = function (a7, a8) {
            return a7 !== a8;
        }, O[aJ(0x20b)] = aI(0x174), O[aI(0x1d6)] = aJ(0x1f9), O[aJ(0x200)] = aI(0x1de), O[aI(0x1a7)] = aI(0x1ae), O[aI(0x21c)] = function (a7, a8) {
            return a7 === a8;
        }, O[aJ(0x1f1)] = aJ(0x1ea), O[aJ(0x1cd)] = function (a7, a8) {
            return a7 !== a8;
        }, O[aI(0x1e3)] = aJ(0x1d3), O[aJ(0x1c6)] = aJ(0x187), O[aI(0x1f0)] = function (a7, a8) {
            return a7 === a8;
        }, O[aI(0x1d2)] = aI(0x19b), O[aI(0x220)] = aJ(0x20e), O[aI(0x17a)] = aJ(0x1af), O[aJ(0x1a9)] = function (a7, a8) {
            return a7 === a8;
        }, O[aJ(0x18f)] = aI(0x1d4), O[aI(0x1dd)] = aJ(0x202), O[aJ(0x1e4)] = aJ(0x1d0), O[aJ(0x196)] = aI(0x182), O[aJ(0x183)] = aI(0x1a6), O[aI(0x1bf)] = aJ(0x208), O[aJ(0x1ef)] = aI(0x1cb), O[aJ(0x1ac)] = aI(0x1e0), O[aJ(0x218)] = aI(0x217), O[aJ(0x1c1)] = aJ(0x214), O[aI(0x21a)] = aI(0x1f2), O[aI(0x191)] = aI(0x212), O[aI(0x1a8)] = aI(0x1c2), O[aJ(0x1b0)] = function (a7, a8) {
            return a7 > a8;
        }, O[aI(0x1e7)] = aI(0x1d8) + aI(0x1ca), O[aI(0x1b9)] = aJ(0x18e), O[aI(0x1a1)] = aJ(0x1b5), O[aJ(0x1b6)] = aJ(0x1a0), O[aI(0x199)] = aJ(0x1c0), O[aI(0x17c)] = function (a7, a8) {
            return a7 !== a8;
        }, O[aI(0x188)] = aI(0x1ce), O[aI(0x21f)] = aI(0x1f4), O[aI(0x1e8)] = aI(0x20d), O[aJ(0x190)] = aI(0x1f5), O[aJ(0x1a2)] = function (a7, a8) {
            return a7 && a8;
        }, O[aI(0x1d9)] = aI(0x1ad);
        const P = O;
        let Q = ![];
        if (K && K[aJ(0x203)]) {
            if (P[aI(0x1c4)](P[aI(0x204)], P[aI(0x1fc)])) {
                const a8 = d[aJ(0x20e)];
                return a8[aI(0x1df) + aI(0x1e6)] = !![], a8;
            } else
                P[aI(0x1fe)](M, P[aI(0x18c)]) ? P[aJ(0x20c)](P[aI(0x20b)], P[aJ(0x20b)]) ? (h[aJ(0x18b)] = P[aJ(0x1b3)], R[aI(0x198)] = S[0x24ff + -0x5f2 + -0x1 * 0x1f0d]['id'], T[aI(0x1ec) + aI(0x17d)] = new U()[aI(0x210)]()) : Q = K[aI(0x211)] : P[aJ(0x177)](P[aI(0x1d6)], P[aI(0x200)]) ? e = f[aI(0x203)][aJ(0x211)] : Q = K[aJ(0x203)][aJ(0x211)];
        }
        if (P[aI(0x1c4)](M, P[aJ(0x1a7)]) && K && Q) {
            if (P[aI(0x21c)](P[aI(0x1f1)], P[aI(0x1f1)])) {
                const aa = {};
                aa[aJ(0x21e)] = F['id'], aa[aI(0x180)] = K[aI(0x203)]?.['id'];
                const ab = {};
                ab[aJ(0x184)] = aa;
                const ac = await CampaignContacts_1[aJ(0x215)][aI(0x1f3)](ab);
                if (ac?.['id']) {
                    if (P[aJ(0x1cd)](P[aJ(0x1e3)], P[aI(0x1c6)])) {
                        const ad = {};
                        return ad[aI(0x1b4) + aJ(0x1e6)] = !![], ad;
                    } else {
                        const af = {};
                        return af[aI(0x215)] = S, af && h[aI(0x194)] ? R : af;
                    }
                }
            } else {
                const ag = {};
                return ag[aJ(0x1b4) + aJ(0x1e6)] = !![], ag;
            }
        }
        if (K && K[aI(0x211)]) {
            if (P[aJ(0x1f0)](P[aJ(0x1d2)], P[aI(0x1d2)])) {
                const ag = {};
                ag[aI(0x180)] = K[aI(0x203)]?.['id'];
                const ah = {};
                ah[aI(0x184)] = ag, ah[aI(0x17b)] = [P[aJ(0x220)]];
                const ai = await Message_1[aI(0x215)][aJ(0x1f3)](ah);
                if (P[aI(0x1c4)](ai?.[aJ(0x20e)]?.[aI(0x18b)], P[aI(0x17a)]) && P[aJ(0x1a9)](ai?.[aI(0x20e)][aI(0x178) + 'e'], K[aJ(0x1c8)])) {
                    if (P[aJ(0x21c)](P[aJ(0x18f)], P[aI(0x18f)])) {
                        const aj = ai[aI(0x20e)];
                        return aj[aI(0x1df) + aI(0x1e6)] = !![], aj;
                    } else
                        e[aI(0x1b2) + aJ(0x1ee)] = null, f[aJ(0x205) + aI(0x1cf)] = ![];
                }
            } else
                P[aI(0x177)](h, P[aJ(0x18c)]) ? V = W[aJ(0x211)] : o = p[aJ(0x203)][aI(0x211)];
        }
        const R = {
                [sequelize_1['Op']['or']]: [
                    P[aJ(0x1b3)],
                    P[aI(0x1dd)]
                ]
            }, S = {};
        S[aJ(0x18b)] = R, S[aI(0x19f)] = I, S[aJ(0x1b8)] = G, S[aJ(0x21e)] = J ? J['id'] : F['id'];
        const T = {};
        T[aJ(0x197)] = Contact_1[aI(0x215)], T['as'] = P[aJ(0x1e4)], T[aJ(0x17b)] = [
            P[aI(0x196)],
            P[aI(0x183)],
            {
                'association': P[aJ(0x1bf)],
                'attributes': [
                    'id',
                    P[aI(0x1ef)]
                ]
            }
        ];
        const U = {};
        U[aI(0x197)] = User_1[aI(0x215)], U['as'] = P[aJ(0x1ac)], U[aJ(0x221)] = [
            'id',
            P[aJ(0x1ef)]
        ];
        const V = {};
        V[aJ(0x1fd) + 'n'] = P[aI(0x1a7)], V[aJ(0x221)] = [
            'id',
            P[aI(0x1ef)],
            P[aJ(0x218)]
        ];
        const W = {};
        W[aI(0x184)] = S, W[aI(0x17b)] = [
            T,
            U,
            V
        ];
        let X = await Ticket_1[aI(0x215)][aI(0x1f3)](W);
        if (X) {
            if (P[aJ(0x1cd)](P[aJ(0x1c1)], P[aI(0x1c1)]))
                e = f[aI(0x211)];
            else {
                H = [
                    P[aJ(0x21a)],
                    P[aI(0x191)],
                    P[aJ(0x18c)],
                    P[aJ(0x1a8)]
                ][aI(0x1bc)](M) && P[aI(0x1b0)](H, 0x1 * 0x1979 + -0x1 * 0x2042 + -0x6c9 * -0x1) ? H += X[aI(0x216) + aJ(0x206)] : H;
                const an = {};
                an[aJ(0x216) + aI(0x206)] = H, await X[aJ(0x1aa)](an);
                const ao = {};
                return ao[aJ(0x19f)] = I, ao[aJ(0x1b7)] = P[aI(0x1e7)], ao[aI(0x1fb)] = X, (0xeb2 + -0x150a * -0x1 + -0x23bc * 0x1, socketEmit_1[aI(0x215)])(ao), X;
            }
        }
        if (J) {
            if (P[aI(0x1c4)](P[aI(0x1b9)], P[aI(0x1a1)]))
                e[aI(0x198)] = f[aI(0x198)];
            else {
                const aq = {};
                aq[aJ(0x21e)] = J['id'], aq[aI(0x19f)] = I, aq[aI(0x1b8)] = G;
                const ar = {};
                ar[aJ(0x184)] = aq, ar[aI(0x1c9)] = [[
                        P[aI(0x1b6)],
                        P[aI(0x199)]
                    ]], ar[aI(0x17b)] = [
                    {
                        'model': Contact_1[aJ(0x215)],
                        'as': P[aI(0x1e4)],
                        'include': [
                            P[aJ(0x196)],
                            P[aJ(0x183)],
                            {
                                'association': P[aI(0x1bf)],
                                'attributes': [
                                    'id',
                                    P[aI(0x1ef)]
                                ]
                            }
                        ]
                    },
                    {
                        'model': User_1[aI(0x215)],
                        'as': P[aJ(0x1ac)],
                        'attributes': [
                            'id',
                            P[aI(0x1ef)]
                        ]
                    },
                    {
                        'association': P[aI(0x1a7)],
                        'attributes': [
                            'id',
                            P[aJ(0x1ef)],
                            P[aJ(0x218)]
                        ]
                    }
                ], X = await Ticket_1[aI(0x215)][aI(0x1f3)](ar);
                if (X) {
                    if (P[aJ(0x17c)](P[aI(0x188)], P[aI(0x188)]))
                        f[aJ(0x1b2) + aJ(0x1ee)] = g, h[aI(0x205) + aI(0x1cf)] = !![];
                    else {
                        const at = {};
                        at[aJ(0x18b)] = P[aJ(0x1dd)], at[aI(0x198)] = null, at[aI(0x216) + aI(0x206)] = H, await X[aI(0x1aa)](at);
                        const au = {};
                        return au[aI(0x19f)] = I, au[aJ(0x1b7)] = P[aI(0x1e7)], au[aI(0x1fb)] = X, (0x2120 + -0x4 * 0x98f + 0x51c, socketEmit_1[aJ(0x215)])(au), X;
                    }
                }
            }
        } else {
            const av = {
                    [sequelize_1['Op']['in']]: [
                        P[aJ(0x1b3)],
                        P[aJ(0x1dd)]
                    ]
                }, aw = {};
            aw[aJ(0x18b)] = av, aw[aI(0x19f)] = I, aw[aI(0x1b8)] = G, aw[aI(0x21e)] = F['id'];
            const ax = {};
            ax[aJ(0x184)] = aw, ax[aJ(0x1c9)] = [[
                    P[aJ(0x1b6)],
                    P[aI(0x199)]
                ]], ax[aI(0x17b)] = [
                {
                    'model': Contact_1[aI(0x215)],
                    'as': P[aI(0x1e4)],
                    'include': [
                        P[aI(0x196)],
                        P[aI(0x183)],
                        {
                            'association': P[aJ(0x1bf)],
                            'attributes': [
                                'id',
                                P[aI(0x1ef)]
                            ]
                        }
                    ]
                },
                {
                    'model': User_1[aI(0x215)],
                    'as': P[aJ(0x1ac)],
                    'attributes': [
                        'id',
                        P[aI(0x1ef)]
                    ]
                },
                {
                    'association': P[aI(0x1a7)],
                    'attributes': [
                        'id',
                        P[aJ(0x1ef)],
                        P[aJ(0x218)]
                    ]
                }
            ], X = await Ticket_1[aJ(0x215)][aI(0x1f3)](ax);
            if (X) {
                const ay = {};
                ay[aJ(0x18b)] = P[aI(0x1dd)], ay[aI(0x198)] = null, ay[aI(0x216) + aJ(0x206)] = H, await X[aI(0x1aa)](ay);
                const az = {};
                return az[aI(0x19f)] = I, az[aI(0x1b7)] = P[aJ(0x1e7)], az[aI(0x1fb)] = X, (-0x33 * 0x65 + -0x1f20 + 0x333f, socketEmit_1[aI(0x215)])(az), X;
            }
        }
        const Y = P[aJ(0x1c4)]((await (-0x3c * 0x9d + -0x119 * 0x11 + 0x1 * 0x3775, ListSettingsService_1[aI(0x215)])(I))?.[aI(0x1e9)](aA => aA[aJ(0x203)] === aI(0x18a) + aJ(0x179) + 'ts')?.[aJ(0x1a5)], P[aJ(0x21f)]) || ![], Z = {
                'contactId': J ? J['id'] : F['id'],
                'status': P[aI(0x1dd)],
                'isGroup': !!J,
                'unreadMessages': H,
                'whatsappId': G,
                'tenantId': I,
                'channel': M,
                'imported': N ? new Date() : null
            }, a0 = {};
        a0['id'] = G;
        const a1 = {};
        a1[aJ(0x184)] = a0;
        const a2 = await Whatsapp_1[aJ(0x215)][aI(0x1f3)](a1);
        if (a2) {
            a2[aJ(0x198)] && (Z[aI(0x198)] = a2[aJ(0x198)]);
            if (a2[aJ(0x1ba)]) {
                Z[aI(0x1ba)] = a2[aJ(0x1ba)];
                const aA = await (0x236d * 0x1 + 0x1b61 + -0x1 * 0x3ece, GetIntegrationsID_1[aI(0x215)])(a2[aJ(0x1ba)]);
                P[aJ(0x21c)](typeof aA, P[aI(0x1e8)]) ? (Z[aI(0x1b2) + aJ(0x1ee)] = aA, Z[aJ(0x205) + aJ(0x1cf)] = !![]) : (Z[aI(0x1b2) + aJ(0x1ee)] = null, Z[aJ(0x205) + aI(0x1cf)] = ![]);
            }
        }
        if (Y && F['id']) {
            const aB = F, aC = await aB[aJ(0x1d7)]();
            aC && aC[0x1d35 + 0x1 * -0x2306 + 0x1 * 0x5d1]?.['id'] && (Z[aJ(0x18b)] = P[aJ(0x1b3)], Z[aJ(0x198)] = aC[-0xd3f * -0x1 + -0x1c72 + 0xf33]['id'], Z[aJ(0x1ec) + aJ(0x17d)] = new Date()[aI(0x210)]());
        }
        K && (Z[aI(0x178) + 'e'] = await (-0xb2e * 0x2 + 0x1 * -0x248 + 0x18a4, VerifyContactBaileys_1[aI(0x1dc) + aJ(0x1fa)])(K));
        const a3 = await Ticket_1[aJ(0x215)][aJ(0x1f5)](Z), a4 = {};
        a4[aI(0x18d)] = a3['id'], a4[aJ(0x1b7)] = P[aI(0x190)], await (0xd9e * -0x2 + -0x7d6 + -0x1 * -0x2312, CreateLogTicketService_1[aI(0x215)])(a4);
        (P[aI(0x1a2)](K, !Q) || L) && await (0x26f7 + 0x3 * -0xcf5 + -0x1 * 0x18, CheckChatBotFlowWelcome_1[aI(0x215)])(a3);
        const a5 = {};
        a5['id'] = a3['id'], a5[aI(0x19f)] = I, X = await (0x20f2 + -0x46c * 0x5 + 0x13 * -0x92, ShowTicketService_1[aJ(0x215)])(a5), X[aJ(0x1e2) + 'ue'](P[aI(0x1d9)], !![]);
        const a6 = {};
        return a6[aJ(0x19f)] = I, a6[aI(0x1b7)] = P[aI(0x1e7)], a6[aI(0x1fb)] = X, (-0x1299 + -0x1 * -0x1f6d + -0xcd4, socketEmit_1[aJ(0x215)])(a6), X;
    };
exports[aG(0x215)] = FindOrCreateTicketService;